v-container(
  fluid
  data-cy = "60"
)
  v-app-bar(
    dark
    color   = "primary"
    data-cy = "61"
  )
    v-btn(
      @click  = "goToHome"
      title   = "Home"
      data-cy = "62"
    )
      v-icon(
        icon = "mdi-home"
        size = "x-large"
      )
    v-app-bar-title
      v-icon.mr-2(icon = "mdi-pencil")
      | Edit Presentation
    v-spacer
    v-btn(
      icon
      @click  = "goToHistory"
      title   = "View History"
      data-cy = "63"
    )
      v-icon(icon = "mdi-history")
    v-btn(
      icon
      @click    = "downloadPPT"
      :disabled = "!currentPPT"
      title     = "Download PPT"
      data-cy   = "64"
    )
      v-icon(icon = "mdi-download")
  v-row(no-gutters)
    // Chat Panel
    v-col.cols-12.md-6(data-cy = "65")
      v-card(
        flat
        height  = "calc(100vh - 64px)"
        data-cy = "66"
      )
        v-card-title.primary.white--text(data-cy = "67")
          v-icon.mr-2(icon = "mdi-pencil")
          | Edit Your Presentation
        v-card-text.chat-container.pa-4(
          ref     = "chatContainer"
          data-cy = "68"
        )
          div.d-flex.mb-4(
            v-for = "(message, index) in messages"
            :key  = "index"
          )
            div.message-bubble.user-message.ml-auto(
              v-if = "message.role === 'user'"
            )
              div.text-right
                div.text-body-1 {{ message.content }}
            div.message-bubble.assistant-message(
              v-else
            )
              div.text-body-1 {{ formatMessage(message.content) }}
          div.text-center.my-4(
            v-if    = "loading"
            data-cy = "69"
          )
            v-progress-circular(
              indeterminate
              color = "primary"
            )
        v-divider
        v-card-actions.pa-4(
          data-cy = "70"
        )
          v-text-field(
            dense
            outlined
            data-cy             = "71"
            v-model             = "inputMessage"
            label               = "Edit your presentation or add more..."
            @keyup.enter        = "handleSendMessage"
            append-inner-icon   = "mdi-send"
            @click:append-inner = "handleSendMessage"
            hide-details
          )
          div.caption.grey--text.mt-2
            v-icon.small.mr-1(icon = "mdi-lightbulb")
            | Try: "Add more slides", "Update slide 1", or "Change title to..."
    // Preview Panel
    v-col.cols-12.md-6.border-left(data-cy = "72")
      v-card(
        flat
        height  = "calc(100vh - 64px)"
        data-cy = "73"
      )
        v-card-title.primary.white--text(data-cy = "74")
          v-icon.mr-2(icon = "mdi-eye")
          | Presentation Preview
        v-card-text.preview-container.text-center.pa-8(data-cy = "75")
          div(v-if = "loadingPPT")
            v-progress-circular.my-8(
              indeterminate
              color = "primary"
              size = "64"
            )
            div.mt-4.body-1.primary--text Generating your PowerPoint...
          div.text-center(
            v-else-if = "presentation"
            data-cy   = "76"
          )
            v-chip.color-primary.large.mb-4(data-cy = "77")
              v-icon.left(icon = "mdi-presentation")
              | {{ presentation.title }}
            v-list.text-left(data-cy = "78")
              v-list-item.mb-4(
                v-for = "(slide, index) in presentation.slides"
                :key  = "index"
              )
                v-card.outlined(data-cy = "79")
                  v-card-title.py-2.primary--text(data-cy = "80")
                    v-icon.small.mr-2(icon = "mdi-file-powerpoint")
                    | {{ slide.title }}
                  v-card-text.py-2(data-cy = "81")
                    div.my-2(
                      v-for = "item, idx in slide.content"
                      :key  = "idx"
                    )
                      span(
                        v-if  = "typeof item === 'object' && item.header"
                        class = "font-weight-bold"
                      ) {{ item.header + ' ' }}
                      span {{ typeof item === 'string' ? item : (item.text || '') }}
          v-empty-state.my-16(
            v-else
            data-cy = "82"
          )
            v-icon.size-64.color-grey(icon = "mdi-file-powerpoint")
            div.mt-4.grey--text Loading presentation...

