v-container(
  fluid
  data-cy = "12"
)
  v-app-bar(
    dark
    color   = "primary"
    data-cy = "13"
  )
    v-btn(
      @click  = "goToHome"
      title   = "Home"
      data-cy = "14"
    )
      v-icon(
        size = "x-large"
        icon = "mdi-home"
      )
    v-app-bar-title
      v-icon.mr-2(icon = "mdi-presentation")
      | AI Chat PPT Generator
    v-spacer
    v-btn(
      icon
      @click  = "goToHistory"
      title   = "View History"
      data-cy = "15"
    )
      v-icon(icon = "mdi-history")
    v-btn(
      icon
      :disabled = "!currentPresentation"
      @click  = "clearHistory"
      title   = "Clear Chat"
      data-cy = "16"
    )
      v-icon(icon = "mdi-delete")
    v-btn(
      icon
      @click    = "downloadPPT"
      :disabled = "!currentPPT"
      title     = "Download PPT"
      data-cy   = "17"
    )
      v-icon(icon = "mdi-download")
  v-row(no-gutters)
    // Chat Panel
    v-col.cols-12.md-6(data-cy = "18")
      v-card(
        flat
        height  = "calc(100vh - 64px)"
        data-cy = "19"
      )
        v-card-text.chat-container.pa-4(
          ref     = "chatContainer"
          data-cy = "20"
        )
          div.d-flex.mb-4(
            v-for = "(message, index) in messages"
            :key  = "index"
          )
            div.message-bubble.user-message.ml-auto(
              v-if = "message.role === 'user'"
            )
              div.text-right
                div.text-body-1 {{ message.content }}
            div.message-bubble.assistant-message(
              v-else
            )
              div.text-body-1 {{ formatMessage(message.content) }}
          div.text-center.my-4(
            v-if    = "loading"
            data-cy = "21"
          )
            v-progress-circular(
              indeterminate
              color = "primary"
            )
        v-divider
        v-card-actions.pa-4(
          data-cy = "22"
        )
          v-text-field(
            variant             = "outlined"
            data-cy             = "23"
            v-model             = "inputMessage"
            label               = "Type your message here..."
            @keyup.enter        = "handleSendMessage"
            append-inner-icon   = "mdi-send"
            @click:append-inner = "handleSendMessage"
            hide-details
          )
    // Preview Panel
    v-col.cols-12.md-6.border-left(data-cy = "24")
      v-card(
        flat
        height  = "calc(100vh - 64px)"
        data-cy = "25"
      )
        v-card-title.primary.white--text(data-cy = "26")
          v-icon.mr-2(icon = "mdi-eye")
          | PowerPoint Preview
        v-card-text.preview-container.text-center.pa-8(data-cy = "27")
          div(v-if = "loadingPPT")
            v-progress-circular.my-8(
              indeterminate
              color = "primary"
              size  = "64"
            )
            div.mt-4.body-1.primary--text Generating your PowerPoint...
          div.text-center(
            v-else-if = "currentPresentation"
            data-cy   = "28"
          )
            v-chip.color-primary.large.mb-4(data-cy = "29")
              v-icon.left(icon = "mdi-presentation")
              | {{ currentPresentation.title }}
            v-list.text-left(data-cy = "30")
              v-list-item.mb-4(
                v-for = "(slide, index) in currentPresentation.slides"
                :key  = "index"
              )
                v-card.outlined(data-cy = "33")
                  v-card-title.py-2.primary--text(data-cy = "34")
                    v-icon.small.mr-2(icon = "mdi-file-powerpoint")
                    | {{ slide.title }}
                  v-card-text.py-2(data-cy = "35")
                    div.my-2(
                      v-for = "item, idx in slide.content"
                      :key  = "idx"
                    )
                      span(
                        v-if  = "typeof item === 'object' && item.header"
                        class = "font-weight-bold"
                      ) {{ item.header + ' ' }}
                      span {{ typeof item === 'string' ? item : (item.text || '') }}
            div.text-center.mt-4(
              v-if = "currentPresentation"
            )
              v-card.outlined(
                color = "info"
                data-cy = "37"
              )
                v-card-text.py-3
                  v-icon.mr-2(color = "primary") mdi-information
                  span.body-2 Want to edit this presentation?
                  br
                  v-btn.mt-3.text.small(
                    @click       = "goToHistory"
                    data-cy      = "38"
                    variant      = "text"
                    text         = "Go to History to Edit"
                    prepend-icon = "mdi-arrow-right"
                  )
          v-empty-state.my-16(
            v-else
            data-cy = "36"
          )
            v-icon.size-64.color-grey(icon = "mdi-file-powerpoint")
            div.mt-4.grey--text No presentation generated yet. Start chatting to create one!

